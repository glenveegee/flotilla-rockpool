
$color-navy: #008ca5; //#4566AD;
$color-yellow: #f8d604;
$color-orange: #DB9800;
$color-blue: #00b0d2;
$color-green: #00ac9c;
$color-red: #ea094b;
$color-purple: #9879D3;
$color-grey: #ebeaea; //#787980;
$color-grey-fg: #d3d1d2;

$color-darkest-navy: #132240;
$color-dark-navy: #182B54;

$color-button: #008ca5;

$icon-size: 72px;
$rule-button-size: 30px;

$color-background: #47b1c4;
$color-flow-background: #0da0b2;
$color-flow-disabled: mix($color-background, $color-flow-background, 50%);
$color-flow-disabled-fg: $color-background;


@font-face {
    font-family: 'flotilla-regular';
    src:url('fonts/flotilla-regular-webfont.eot?-moe4l1');
    src:url('fonts/flotilla-regular-webfont.eot?#iefix-moe4l1') format('embedded-opentype'),
        url('fonts/flotilla-regular-webfont.woff?-moe4l1') format('woff'),
        url('fonts/flotilla-regular-webfont.ttf?-moe4l1') format('truetype'),
        url('fonts/flotilla-regular-webfont.svg?-moe4l1#boo') format('svg'),
        url('fonts/flotilla-regular-webfont.otf') format('otf');

    font-weight: normal;
    font-style: normal;
}

html, body {
    width:100%;
    height:100%;
    padding:0;
    margin:0;
}

h1, h2, h3, h4, .name {
    font-family:Roboto;
}

h2 {
    font-size: 14pt;
    font-weight: 300;
    color:#ffffff;
    margin:0;
    padding:0;
}

body {
    background-color:$color-background;
}

.container > header {
    overflow:hidden;
}

.container > header {
    margin-bottom: -15px;
    padding-top: 20px;
}

.mainnav {

    i:after {
        font-family: flotilla-regular;
        font-style: normal;
        position: relative;
        font-size: 30px;
        top: 3px;
        line-height: 0;
    }
    ul, li {
        margin:0;
        padding:0;
        list-style:none;
        display:inline-block;
    }
    ul {
        font-size:0;
    }
    li {
        margin:5px 5px 5px 0px;
        font-size:14px;
        padding:14px;
        color:#FFF;
        cursor:pointer;
        border-radius:5px;

        &:hover i, i {background:transparent;}


        &.pull-right {
            float:right;
        }
        &.logo {
            margin-left:5px;
            padding:0;
            i:after {
                font-size: 50px;
                top: 7px;
            }
        }
    }
}

.center { text-align: center; }
.right { text-align: right; }

.block { 
    position: relative;
    margin: 12px 0px;
    height:72px;
}
//i img {max-width:100%;width:100%;height:auto;margin:0 auto;}

.palette.converter hr {
    display:block;
    width:100%;
    clear:both;
    padding:0; 
    margin-top:0;
    margin-bottom:15px;
    border:none;
    border-top:2px solid rgba(255,255,255,0.5);
}

.block i, .icon-palette i, .palette i, .add-manual i {
    position: relative;
    display: block;
    width: 72px;
    height: 72px;
    border-radius: 36px;
    background-color: #787980;
    color:#FFF;
    font-size:72px;
    line-height:72px;
    text-align:center;
    cursor:pointer;
    z-index:1;

    &:after {
        width:72px;
        height:72px;
        line-height:56px;
        font-size:87px;
        text-align:center;
        position:absolute;
        left:0;
        top:0;
        font-family:flotilla-regular;
        font-style:normal;
        color:#FFF;
    }
}

.add-manual {
    position:absolute;
    right:15px;
    bottom:-34px;
    height:72px;
    color:#FFFFFF;
    font-size:18px;
    padding-right:82px;
    
    i {
        background-color: #ED1558;
        position:absolute;
        right:0;
        bottom:0;
    }

    span {
        position: relative;
        top: 44px;
    }
}

/*
############################################ Icons ############################################
*/

@mixin icon($name, $char){
    i.icon-#{$name}:after {content:$char;}
}

/* Real Inputs */
@include icon("weather","B");
@include icon("number","N");
@include icon("joystick","J");
@include icon("dial","D");
@include icon("slider","S");
@include icon("color","C");
@include icon("colour","C");
@include icon("motion","m");
@include icon("touch","T");
@include icon("light","L");
@include icon("motor","M");
@include icon("matrix","n");
@include icon("rainbow","R");

/* Virtual Inputs */
@include icon("value","v");
@include icon("clock","t");
@include icon("random","r");
@include icon("sine","s");
@include icon("square","q");
@include icon("keyboard","K");
@include icon("variable","V");

/* Converters */
@include icon("halve","h");
@include icon("double","z");
@include icon("invert","i");
@include icon("smooth","a");
@include icon("toggle","O");
@include icon("add","A");
@include icon("subtract","x");
@include icon("min","W");
@include icon("max","w");
@include icon("diff","d");
@include icon("mix","a");
@include icon("gt","g");
@include icon("lt","l");
@include icon("latch","h");

/* Utilities */
@include icon("peek","P");
@include icon("poke","p");
@include icon("dock","f");
@include icon("flotilla","F");
@include icon("help","H");
@include icon("clear","c");

.block i {
    margin-left:-36px;
    left: 50%;
}

i .name {
    height: 22px;
    width: 100%;
    position: absolute;
    top: 72px;
    display:block;
    span {
        background:#FFF;
        width:18px;
        height:18px;
        border-radius:9px;
        color:$color-darkest-navy;
        display:inline-block;
        line-height:17px;
        font-size: 13px;
        font-weight: 700;
        display:none;
    }
}

i .name, .icon-palette span {
    color:#FFF;
    font-style: normal;
    text-align: center;
    white-space:nowrap;
    text-transform: lowercase;
    font-weight: 300;
    font-size: 16px;
    line-height:22px;
    text-shadow:0px 2px rgba(0,0,0,0.4);
}

.inspector {
    display:none;
}

footer {
    padding-bottom:60px;
}


.palette {
    z-index: 9000;
    display:block;
    width:auto;
    height:100%;
    max-width:760px;
    margin:20px auto;
    position:relative;
    margin-top:40px;

    header {
        text-align:center;

        h1 {
            color:#FFFFFF;
            font-size:24pt;
            padding:.67em 0;
            margin:0;
        }
    }

    &.input:before, &.output:before {
        content:'';
        width:240px;
        height:240px;
        position:absolute;
        left:50%;
        margin-left:-120px;
        background:url('images/flotilla-dock.png') no-repeat center center;
        background-size:cover;
        top:-160px;
        z-index:2;
    }

    &.input, &.output {
        .connected-modules {
            padding-top: 140px;
        }
    }

    &.host-picker, 
    &.save-load,
    &.personalise,
    &.confirm {
        border-radius:20px;
        background:#00B0D2;
    }

    &.save-load,
    &.personalise,
    &.confirm {
        border-radius:20px;
        background:#224280;
        margin-bottom:36px;
    }

    &.personalise {
        padding-bottom:30px;
    }

    &.save-load {
        li {
            position:relative;
            &:nth-child(odd) {
                background: #195E95;
            }
        }
        .delete {
            background-color:#ED1457;
        }
        .download {
            background-color:#02B186;
            position:absolute;
            right:67px;

            &:before {
                content: '';
                display:block;
                background:transparent;
                width:0;
                height:0;
                border: 21px solid transparent;
                border-top-color: #FFF;
                position: absolute;
                left: 15px;
                top: 31px;
            }
        }
    }

    .close {
        position:absolute;
        right:-30px;
        top:-30px;
        background:#787980;
        width:60px;
        height:60px;
        border-radius: 30px;
    }
}

.palette .close,
i.confirm,
i.delete,
i.cancel {
    &:before, &:after {
        width:40px;
        height:10px;
        background:#FFFFFF;
        content:'';
        display:block;
        position:absolute;
        top:25px;
        left:10px;
        transform-origin:20px 5px;
        -webkit-transform-origin:20px 5px;
        transform:rotate(46deg);
        -webkit-transform:rotate(45deg);
        top:32px;
    }
}

.palette .close:before,
i.delete:before,
i.confirm:before,
i.cancel:before {
    transform:rotate(46deg);
    -webkit-transform:rotate(-45deg);
}

.palette .close {
    top:auto;
}

i.confirm {
    -webkit-transition:background-color 0.1s ease-in;
    transition:background-color 0.1s ease-in;

    &:after {
        width: 15px;
        top: 48px;
        left: 5px;
    }
}

.save-load {
    i.delete, i.confirm {
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
        position:absolute;
        right:-15px;
        top:12px;
    }
}


/*
############################################ Host Picker ############################################
*/

.progress {
    position:relative;
    display:block;
    width:100%;
    height:40px;

    span {
        display:block;height:100%;
        -webkit-transition:width 0.2s;
        background:#95c11f;
    }

    strong {
        color:#FFF;
        display:block;
        position:absolute;left:0;top:0;
        width:100%;height:100%;
        line-height:40px;
        text-align:center;
        font-size:20px;
    }
}

.host-picker {
    display: block;
    height:100%;
    min-height:300px;
    margin-bottom:40px;
    padding-bottom:40px;

    .host {
        width:172px;
        display:inline-block;
        line-height:30px;
        text-align:center;
        font-size: 30px;
        color:#FFF;
        margin-left:10px;
        position:relative;
        cursor:pointer;
        padding-bottom:40px;

        .error {
            color:#ffffff;   
            font-size: 12px;
            position: absolute;
            bottom: 0px;
            left: 0px;
            width: 100%;
            text-align: center;

            &:after {
                content: '!';
                border-radius: 50%;
                background: #ED1558;
                width: 40px;
                height: 40px;
                position: absolute;
                left: 50%;
                margin-left: -20px;
                top: -35px;
                font-size: 36px;
                line-height: 40px;
            }

            em {
                font-style:normal;
                text-decoration:underline;
            }
        }

        &:after {
            content:'';
            display:block;
            width:140px;
            height:140px;
            border-radius:70px;

            margin:0 auto;
            margin-top:10px;

            background-image: url('images/flotilla-dock.png');
            background-size: cover;
            background-position: center center;
            background-color: transparent;
        }

        &.update-needed {
            color:rgba(255,255,255,0.6);
        }

        p {
            margin:0;
            padding:0;
            padding-top:0px;
        }

        small {
            font-size:20px;
            display:block;
        }
    }

     .choices {
        padding:10px;
        overflow: hidden;
    }

    .daemon {
        display:inline-block;
        float:left;
        > h3, > p {
            color:#FFF;
            font-size:20px;
            text-align:center;
            display: block;
            margin:10px;
        }
    }

    .none-found {
        margin:0 auto;
        width:247px;
        height:72px;
        background:$color-dark-navy;
        color:#FFFFFF;
        text-align:center;
        line-height:72px;
        border-radius:46px;
        font-size:18px;
        position:relative;

        &:after {
            content:'';
            color: rgba(255,255,255,0.6);
            font-size: 20px;
            margin: 100px auto;
            width: 0.5em;
            height: 0.5em;
            border-radius: 50%;
            position: absolute;
            top:50px;
            left:50%;
            text-indent: -9999em;
            -webkit-animation: load4 1.3s infinite linear;
            animation: load4 1.3s infinite linear;
            -webkit-transform: translateZ(0);
            -ms-transform: translateZ(0);
            transform: translateZ(0);
        }
    }
}


/*
############################################ Confirm Dialog ############################################
*/


.confirm {
    .choices {
        text-align:center;
        margin-bottom:-36px;
        i {
            margin:0 20px;
        }
    }
    i {
        display:inline-block;
        &.confirm {
            background:$color-red;
            &:hover {
                background:lighten($color-red,5%);
            }
            &:before {
                left:18px;
            }
            &:after {
                left:13px;
            }
        }
        &.cancel {
            background:$color-green;
            &:hover {
                background:lighten($color-green,5%);
            }
            &:before, 
            &:after {
                left:16px;
            }
        }
    }
}

.host-picker, .save-load, .confirm {
    .custom {
        float:left;
        display:block;
        width:200px;
        height:200px;
        font-size: 20px;
        border-radius:10px;
        background:rgba(0,0,0,0.5);
        color:#FFF;

        h3 {
            margin:0;
            padding:10px;
            padding-bottom:0;
        }

        p {
            margin:0;
            padding:10px;
            font-size:16px;
        }

        a {
            margin:0 10px;
            text-decoration:none;
            line-height:30px;
            display:block;
            text-align:center;
            color:#FFF;
            background:#95c11f;
        }

        input {
            border:none;
            color:#FFF;
            font-weight:bold;
            text-align:left;
            padding:10px;
            width:160px;
            margin:0 10px;
            color:#333;
        }
    }
}

.host-picker .custom {
    position:absolute;
    bottom:0;
    right:15px;
    border-bottom-left-radius:0;
    border-bottom-right-radius:0;

    h3 {
        margin-bottom:5px;
        font-size:18px;
    }
}

@-webkit-keyframes load4 {
    0%,
    100% {
    box-shadow: 0 -3em 0 0.2em, 2em -2em 0 0em, 3em 0 0 -1em, 2em 2em 0 -1em, 0 3em 0 -1em, -2em 2em 0 -1em, -3em 0 0 -1em, -2em -2em 0 0;
    }
    12.5% {
    box-shadow: 0 -3em 0 0, 2em -2em 0 0.2em, 3em 0 0 0, 2em 2em 0 -1em, 0 3em 0 -1em, -2em 2em 0 -1em, -3em 0 0 -1em, -2em -2em 0 -1em;
    }
    25% {
    box-shadow: 0 -3em 0 -0.5em, 2em -2em 0 0, 3em 0 0 0.2em, 2em 2em 0 0, 0 3em 0 -1em, -2em 2em 0 -1em, -3em 0 0 -1em, -2em -2em 0 -1em;
    }
    37.5% {
    box-shadow: 0 -3em 0 -1em, 2em -2em 0 -1em, 3em 0em 0 0, 2em 2em 0 0.2em, 0 3em 0 0em, -2em 2em 0 -1em, -3em 0em 0 -1em, -2em -2em 0 -1em;
    }
    50% {
    box-shadow: 0 -3em 0 -1em, 2em -2em 0 -1em, 3em 0 0 -1em, 2em 2em 0 0em, 0 3em 0 0.2em, -2em 2em 0 0, -3em 0em 0 -1em, -2em -2em 0 -1em;
    }
    62.5% {
    box-shadow: 0 -3em 0 -1em, 2em -2em 0 -1em, 3em 0 0 -1em, 2em 2em 0 -1em, 0 3em 0 0, -2em 2em 0 0.2em, -3em 0 0 0, -2em -2em 0 -1em;
    }
    75% {
    box-shadow: 0em -3em 0 -1em, 2em -2em 0 -1em, 3em 0em 0 -1em, 2em 2em 0 -1em, 0 3em 0 -1em, -2em 2em 0 0, -3em 0em 0 0.2em, -2em -2em 0 0;
    }
    87.5% {
    box-shadow: 0em -3em 0 0, 2em -2em 0 -1em, 3em 0 0 -1em, 2em 2em 0 -1em, 0 3em 0 -1em, -2em 2em 0 0, -3em 0em 0 0, -2em -2em 0 0.2em;
    }
}
@keyframes load4 {
    0%,
    100% {
    box-shadow: 0 -3em 0 0.2em, 2em -2em 0 0em, 3em 0 0 -1em, 2em 2em 0 -1em, 0 3em 0 -1em, -2em 2em 0 -1em, -3em 0 0 -1em, -2em -2em 0 0;
    }
    12.5% {
    box-shadow: 0 -3em 0 0, 2em -2em 0 0.2em, 3em 0 0 0, 2em 2em 0 -1em, 0 3em 0 -1em, -2em 2em 0 -1em, -3em 0 0 -1em, -2em -2em 0 -1em;
    }
    25% {
    box-shadow: 0 -3em 0 -0.5em, 2em -2em 0 0, 3em 0 0 0.2em, 2em 2em 0 0, 0 3em 0 -1em, -2em 2em 0 -1em, -3em 0 0 -1em, -2em -2em 0 -1em;
    }
    37.5% {
    box-shadow: 0 -3em 0 -1em, 2em -2em 0 -1em, 3em 0em 0 0, 2em 2em 0 0.2em, 0 3em 0 0em, -2em 2em 0 -1em, -3em 0em 0 -1em, -2em -2em 0 -1em;
    }
    50% {
    box-shadow: 0 -3em 0 -1em, 2em -2em 0 -1em, 3em 0 0 -1em, 2em 2em 0 0em, 0 3em 0 0.2em, -2em 2em 0 0, -3em 0em 0 -1em, -2em -2em 0 -1em;
    }
    62.5% {
    box-shadow: 0 -3em 0 -1em, 2em -2em 0 -1em, 3em 0 0 -1em, 2em 2em 0 -1em, 0 3em 0 0, -2em 2em 0 0.2em, -3em 0 0 0, -2em -2em 0 -1em;
    }
    75% {
    box-shadow: 0em -3em 0 -1em, 2em -2em 0 -1em, 3em 0em 0 -1em, 2em 2em 0 -1em, 0 3em 0 -1em, -2em 2em 0 0, -3em 0em 0 0.2em, -2em -2em 0 0;
    }
    87.5% {
    box-shadow: 0em -3em 0 0, 2em -2em 0 -1em, 3em 0 0 -1em, 2em 2em 0 -1em, 0 3em 0 -1em, -2em 2em 0 0, -3em 0em 0 0, -2em -2em 0 0.2em;
    }
}


.saves {
    padding:0px;
    padding-top:0px;
    padding-bottom:30px;
    overflow: hidden;
    overflow:hidden;

    .file-drop-zone {
        border-radius: 10px;
        border: 10px dotted #195E95;
        margin: 0px 10px 10px 10px;
        padding: 15px;
        background: rgba(25, 94, 149, 0.3);
        color: #195E95;
        text-align: center;
        text-transform: lowercase;
        font-size: 30px;
        font-weight: bold;
    }

    ul, li {
        margin:0;
        padding:0;
        list-style:none;
    }
    li {
        padding:10px 0px 10px 10px;
    }
    i {
        display:inline-block;
    }
    span {
        color:#FFFFFF;
        height:72px;
        line-height:72px;
        font-size:22px;
        vertical-align:top;
        padding-left:10px;
    }
}

.file-drop-zone.invalid {
    border-color: #ed1457;
    background: rgba(237, 20, 87, 0.3);
    color: #ed1457;
    transition:background 0.2s, color 0.2s, border-color 0.2s;
}

.save-load .add, .personalise .dockSubmit {
    position: absolute;
    left: 50%;
    bottom:-36px;
    margin-left: -36px;
    background-color:#00AB9B;
}

.save-load, .personalise, .confirm {
    input {
        width: 480px;
        height: 50px;
        line-height: 50px;
        border: 3px solid #00B0D2;
        border-radius: 5px;
        text-align: center;
        font-size: 22px;
        color: #00B0D2;
        margin: 0px auto;
        display: block;
        margin-bottom: 30px; 
    }

    p {
        color:#00B0D2;
        text-align:center;
        margin-top:0;
        padding-top:0;
    }
}



.fancybox-overlay {}
.fancybox-outer, .fancybox-wrap, .fancybox-skin, .fancybox-inner {background:transparent;}
.fancybox-close {display:none;}
.fancybox-opened .fancybox-skin {background: transparent;-webkit-box-shadow:none;box-shadow:none;}

.block .add-input, .block .add-output {
    background:#091224;
}

.block .add-input:before, .block .add-output:before, .add-manual i:before,
.save-load .add:before, .save-load .add:after,
.block .add-input:after, .block .add-output:after, .add-manual i:after  {
    width:52px;
    height:14px;
    background:#FFFFFF;
    content:'';
    display:block;
    position:absolute;
    top:30px;
    left:10px;
    transform-origin:26px 7px;
    -webkit-transform-origin:26px 7px;
}

.block .add-input:before, .block .add-output:before, .add-manual i:before, .save-load .add:before {
    transform:rotate(90deg);
    -webkit-transform:rotate(90deg);
}

/*
############################################ Rules ############################################
*/


$pipe-size: $icon-size*0.65;

.graph {
    background:$color-flow-background;
    height: $pipe-size;
    width: 100%;
    position: absolute;
    left: 50%;
    top:($icon-size - $pipe-size)/2;
}

canvas {
    border-top-color:    rgba(255,255,255,0.9); /* strokeStyle */
    border-bottom-color: rgba(255,255,255,0.1); /*  fillStyle  */

    display:block;
    width:100%;
    height:$pipe-size;
}

.pipe {
    border-radius:0;
    padding:$pipe-size 0;
    box-sizing:border-box;

    width: $pipe-size;
    position: absolute;
    left: 50%;
    margin-left:-($pipe-size/2);
    border-bottom-right-radius: $pipe-size/2;
    border-top-right-radius: $pipe-size/2;

    span {
        width:100%;
        height:100%;
        display:block;
        position: relative;
        background:$color-flow-background;
        z-index:-1;

        &:before, &:after {
            content: '';
            width:$pipe-size/2;
            height:$pipe-size;
            position: absolute;
            right:0px;
            background:$color-flow-background;
        }

        &:before {
            top:-($pipe-size) + (($icon-size - $pipe-size)/2);
            bottom:auto;
            border-top-right-radius: $pipe-size/2;
        }

        &:after {
            bottom:-($pipe-size) + (($icon-size - $pipe-size)/2);
            top:auto;
            border-bottom-right-radius: $pipe-size/2;
        }
    }
}

/* Overlays, Palettes and modals */

.fancybox-overlay, .modal {
    background-image:none;
    background-color:rgba(0, 0, 0, 0.90);
}


/*
############################################ IO Indicators ############################################
*/

.controls {
    padding-top:20px;
    text-align: center;

    .add-rule {
        height: 44px;
        border-radius: 11px;
        display: inline-block;
        background: $color-button;
        font-size: 25px;
        line-height: 44px;
        margin: 0 auto;
        color: #FFF;
        cursor: pointer;
        padding: 0 15px;

        font-weight:700;

        &:hover {
            background:lighten($color-green,5%);
        }
    }
}

/*
############################################ Pop-up Menus ############################################
*/

.active.selected {
    i:before {
        content:'';
        border:20px solid transparent;
        border-bottom-color:#333333;
        position:absolute;
        top:57px;
        margin-left:-20px;
        left:50%;
    }

    &.above {
        i:before {
            border-bottom-color:transparent;
            border-top-color:#333333;
            position:absolute;
            top:-28px;
        }
        span {
            display:block;
        }
    }
    span {
        display:none;
    }
}

.popup {
    z-index:10;
    margin-top:25px;
    position:absolute;
    top:72px;

    ul, li {
        list-style:none;
        margin:0;
        padding:0;
    }

    ul {
        white-space: pre;
    }

    li {
        display:inline-block;
        background:#224280;
        color:#FFFFFF;
        height:40px;
        line-height: 40px;
        margin-left: 5px;
        margin-top: 5px;
        cursor:pointer;
        cursor:hand;
        vertical-align:top;
        font-weight:300;
        text-transform: lowercase;
        font-size:16px;
        padding: 0 30px;
        position:relative;

        border-radius:23px;
        border-top-left-radius:0;
        border-bottom-left-radius:0;
        border:3px solid #FFF;

        margin-right:-23px;

        &.button {
            font-weight:bold;
            font-size:18px;
        }

        &:nth-child(1){z-index:9;}
        &:nth-child(2){z-index:8;}
        &:nth-child(3){z-index:7;}
        &:nth-child(4){z-index:6;}
        &:nth-child(5){z-index:5;}
        &:nth-child(6){z-index:4;}
        &:nth-child(7){z-index:3;}
        &:nth-child(8){z-index:2;}
        &:nth-child(9){z-index:1;}

        &:last-child {
            margin-right:0;
        }

        &:first-child {
            border-top-left-radius:23px;
            border-bottom-left-radius:23px;
        }
    }

    .slider {
        padding:0;
        position: relative;
        width:400px;
        height:40px;

        span {
            position:absolute;
            display:block;
            top:1px;
            height:38px;
            width:1px;
            background:rgba(0,0,0,0.2);
            margin-top:0;
        }
        div {
            background:#95c11f;
            position:absolute;
            left:0;
            top:0;
            height:40px;
        }
        strong {
            position:absolute;
            left:0;
            top:0;
            width:100%;
            text-align:center;
            z-index:1;
        }
    }
}

.above .popup {
    border-top:0;
    z-index:10;
    margin-top:0px;
    margin-bottom:25px;
    top:-78px;

    li {
        margin-top:0;
        margin-bottom:5px;
    }
}

.popup li:nth-child(1){
    margin-left:0;
}

.block {
    .popup {
        left:50%;
        top:12px;
        margin-left:40px;
        margin-top:0;
        border-top:0;
        padding:0 5px;

        li {
            margin-top:0;

            &:last-child {
                margin-right:-23px;
            }
        }
        &:before, &:after {
            content:'';
            position:absolute;
            z-index:10;
        }
        &:before {
            top:3px;
            left:-12px;

            background:$color-grey;
            width:40px;
            height:40px;
            border-radius:20px;
        }
        &:after {
            top:13px;
            left:-12px;

            border:10px solid transparent;
            border-right-color:$color-grey-fg;
            border-right-width:15px;
        }
    }
    &.output .popup {
        left:auto;
        right:50%;
        margin-left:0;
        margin-right:60px;
        &:before {
            content:'';
            border:20px solid transparent;
            border-left-color:#333333;
            position:absolute;
            top:0px;
            left:auto;
            right:-40px;
        }
    }
}

.blackout {
    display:block;
    width:100%;
    height:100%;
    background: rgba(mix(#000,$color-background,70%), 0.95);
    left:0;
    top:0;
    position:fixed;
    z-index:100;
    display:none;
}

.blackedout .blackout {
    display:block;
}

#rules .block.selected i, #rules .block.selected .popup {
    z-index:200;
}
#rules .block.selected i .inspector {display:none;}

/* Config Slider */

.connected-modules, .virtual-modules, .modifiers {
    display:block;
    background:#404040;
    border-radius:20px;
    padding:30px;
    position: relative;

    &:before {
        content:'';
        position:absolute;
        width:100%;
        height:50px;
        border-radius:20px;
        bottom:-10px;
        background-color:#262626;
        left:0px;
        z-index:-1;
    }
}

.modifiers {
    padding-bottom:10px;

    .icon-palette > div {
        margin-bottom:20px;
    }
}

.virtual-modules {
    background:$color-darkest-navy;
    margin-top:20px;

    &:before {
        background:#0B1526;
    }
}

.greyout {
    .connected-modules {
        background:#151515;
        &:before {
            background:#111111;
        }
    }

    .virtual-modules {
        background:#090F1D;
        &:before {
        background:#050A13;
        }
    }

    .icon-palette > div {
        opacity:0.1;
        -webkit-filter: blur(1px);
    }

    .icon-palette > div.selected {
        position: relative;
        z-index: 1
    }

    .icon-palette > div.active:hover {
        opacity:0.2;
        -webkit-filter: none;
    }

    .icon-palette > div.selected,
    .icon-palette > div.selected:hover{
        opacity:1.0;
        -webkit-filter: none;
    }
}

.icon-palette {
    span {
        display:block;
        color:#FFF;
        text-align:center;
        margin-top:5px;
    }
    > div {
        display: inline-block;
        zoom: 1;
        letter-spacing: normal;
        word-spacing: normal;
        vertical-align: top;
        text-rendering: auto;
        width: 12.5%;
        position: relative;
        height:95px;
    }
    i {
        margin: 0 auto;
    }
}

.channels .color-grey {
    &.disabled i {
        position:relative;
        background-color:#1C1C1C;
        border:2px solid #1C1C1C;
        overflow:hidden;
        box-sizing:border-box;

        & :after {
            content:'';
            background-color:#292929;
            width:72px;
            height:72px;
            border-radius:50%;
            position:absolute;
            left:-2px;
            top:8px;
        }
    }

    i {
        color:#404040;
        background-color:#555555;
    }

    span {
        color:#555555;
    }
}

.config-slider {
    background: #333;
    height: 72px;
    margin: 10px 87px 25px 87px;
    position:relative;
    background-image: linear-gradient(90deg, transparent 99%, rgba(0, 0, 0, .2) 100%);
    background-size:10.1%;
    background-position:0 0;

    div {
        height: 72px;
        width:50%;
        background:#02B186;
    }

    span.status {
        width:100%;
        position:absolute;
        left:0;
        top:0;
        text-align:center;
        line-height:72px;
        color:#FFFFFF;
        font-size:20pt;
    }

    .icon-on, .icon-off {
        position:absolute;
        top:0;
        left:-77px;
    }

    .icon-off {
        border-top-right-radius:0px;
        border-bottom-right-radius:0px;
    }

    .icon-on {
        right:-77px;
        left:auto;
        border-top-left-radius: 0px;
        border-bottom-left-radius: 0px;
    }

    .current, .icon-off {
        background:#01A176;
    }
}

.configure-widget .save {
    margin-top:10px;
}

/*
############################################ Colours ############################################
*/

@mixin colour-setting($name, $color, $color-fg) {
    .color-#{$name} {
        i, li {
            background-color:$color;
        }
        .popup li {
            border-color:darken($color,15%);
        }
        li:hover {
            background-color:lighten($color,10%);
        }
        i:after {
            color:$color-fg;
        }
    }

    .mainnav .color-#{$name} {
        background-color:$color;
        &:hover {
            background-color:lighten($color,10%);
        }
    }

    .color-#{$name}.block .popup:before {
        border-right-color:$color;border-left-color:$color;
    }

    .color-#{$name}.active.selected i:before,


    .color-#{$name}.above.active.selected i:before,
    .color-#{$name} canvas {
        border-top-color:$color;
    }

    .color-#{$name}.above.active.selected i:before {
        border-bottom-color:transparent;
    }
}

/* Hack to set line and fill colours of graphs in CSS */
.generators canvas {
    border-top-color:    rgba(0, 159, 227, 1.0); /* strokeStyle */
}
.decider canvas {
    border-top-color:    rgba(149, 30, 128, 1.0); /* strokeStyle */
}
.converter canvas {
    border-top-color:    rgba(229, 0, 81, 0.9); /* strokeStyle */
}

@include colour-setting("navy",   $color-navy, #FFFFFF);
@include colour-setting("yellow", $color-yellow, #FFFFFF);
@include colour-setting("orange", $color-orange, #FFFFFF);
@include colour-setting("blue",   $color-blue, #FFFFFF);
@include colour-setting("green",  $color-green, #FFFFFF);
@include colour-setting("red",    $color-red, #FFFFFF);
@include colour-setting("purple", $color-purple, #FFFFFF);
@include colour-setting("grey",   $color-grey, $color-grey-fg);


/*
############################################ Disabled Rules ############################################
*/

#rules {
    padding-bottom: 30px;
    overflow: hidden;

    .block.output .popup:before {border-right-color:transparent;}
    .block.input .popup:before, .block.converter .popup:before {border-left-color:transparent;}

    .rulegroup {
        position:relative;
        display:block;

        .rule {
            margin: 10px 0;

            .toggle, .delete {
                position:absolute;
                top:10px + ($icon-size/2) - ($rule-button-size/2);

                i {
                    position:relative;
                    display:block;
                    width:$rule-button-size;
                    height:$rule-button-size;
                    background:$color-grey;
                    color:$color-grey-fg;
                    text-align:center;
                    line-height:$rule-button-size;
                    border-radius:$rule-button-size/2;
                    cursor:pointer;
                    z-index:1;
                }
            }

            .toggle {
                left:10px;
            }

            .delete {
                right:10px;
            }
        }

        .block i,
        .toggle i,
        .graph,
        .pipe span,
        .pipe span:before,
        .pipe span:after {
            -webkit-transition: background-color linear 0.1s;
            transition: background-color linear 0.1s;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none; 
            -moz-user-select: none; 
            -ms-user-select: none;
            user-select: none;   
        }

        .toggle i .on,
        .toggle i .off {display:none;}

        // Pause button
        .toggle i, .delete i {
            position:relative;
            &:before, &:after {
                content:'';
                display:block;
                width:($rule-button-size/23)*4;
                height:$rule-button-size/2;
                background:$color-grey-fg;
                display:block;
                position:absolute;
                left: (($rule-button-size/23) * 8) - (($rule-button-size/23)*2);
                top: $rule-button-size/4;
                border-radius:2.5px;
           }
           &:after {
                left: auto;
                right: (($rule-button-size/23) * 8) - (($rule-button-size/23)*2);
           }
        }

        .delete i {
            &:before, &:after {
                transform-origin:($rule-button-size/23)*2, $rule-button-size/4;
                transform:rotate(45deg);
                left:($rule-button-size/23)*10;
                top:$rule-button-size/4;
                right:auto;
            }
            &:after
            {
                transform:rotate(-45deg);
            }
        }

        &.off {
            // Play Button
            .toggle i {
                &:before, &:after {
                    width:0;
                    height:0;
                    border:($rule-button-size/4) solid transparent;
                    border-left-color: $color-flow-disabled-fg;
                    background: transparent;
                    left: $rule-button-size/3;
                    border-left-width: $rule-button-size/3;
               }
               &:after {display:none;}
            }

            canvas {display:none;}
            .block i,
            .toggle i,
            .graph,
            .pipe span,
            .pipe span:before,
            .pipe span:after {
                background-color:$color-flow-disabled;
                -webkit-transition: background-color linear 0.1s;
                transition: background-color linear 0.1s;
            }

            .toggle i:hover {
                background:$color-grey;
                &:before, &:after {
                    border-left-color: $color-grey-fg;
                }
            }

            i:after, i .name {color:$color-flow-disabled-fg;}

            i .name {display:none;}

            .block .inspector,
            .empty .name,
            .none .name {display:none;}

        }
    }
}

@media(max-width:860px){
    .palette .close {
        right:10px;
    }
}

@media(max-width:719px){
    .palette div i, .palette div i:after {
        width: 50px;
        height: 50px;
        border-radius: 25px;
        font-size: 50px;
        line-height: 50px;
    }
    .icon-palette span {
        font-size:12px;
    }
}
@media(min-width:720px){
    .connected-modules .icon-palette > div {
        &.active:before {
            content: '';
            display: block;
            border-left: 10px solid #00B0B2;
            width: 0;
            position: absolute;
            top: -27px;
            left: 40px;
            transform-origin: 5px 0;
            -webkit-transform-origin: 5px 0;
        }

        &:nth-of-type(1).active:before,
        &:nth-of-type(2).active:before,
        &:nth-of-type(3).active:before,
        &:nth-of-type(4).active:before {
            transform: rotate(224deg);
            -webkit-transform: rotate(224deg);
            height: 240px;
        }

        &:nth-of-type(5).active:before,
        &:nth-of-type(6).active:before,
        &:nth-of-type(7).active:before, 
        &:nth-of-type(8).active:before {
            transform: rotate(-224deg);
            -webkit-transform: rotate(-224deg);
            height: 240px;
        }

        &:nth-of-type(3).active:before,
        &:nth-of-type(6).active:before {
            top: -44px;
            height: 80px;
        }

        &:nth-of-type(4).active:before,
        &:nth-of-type(5).active:before {
            top: -50px;
            height: 40px;
        }
        &.active:after {
            content: '';
            display: block;
            border-left: 10px solid #00B0B2;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
            width: 0;
            height: 30px;
            position: absolute;
            top: -32px;
            left: 40px;
        }

        &:nth-of-type(4).active:after,
        &:nth-of-type(5).active:after {
            top:-55px;
            height:53px;
        }

        &:nth-of-type(3).active:after,
        &:nth-of-type(6).active:after {
            top:-49px;
            height:47px;
        }
    }
}
